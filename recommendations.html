<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Your Next Skill ‚Äì SpendSomeTime</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#f0f7ff;
  --panel:#ffffffcc;
  --border:#d0e4ff;
  --accent:#ff7eb9;
  --accent2:#58d9ff;
  --text:#1a1a1a;
  --muted:#555555;
  --success:#4ade80;
  --shadow: rgba(0,0,0,0.1);
}

* {
  box-sizing:border-box;
  font-family:'Inter', system-ui, sans-serif;
  scroll-behavior: smooth;
}

body {
  margin:0;
  background: var(--bg);
  color: var(--text);
}

nav {
  position: fixed;
  top: 0;
  width: 100%;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid var(--border);
  padding: 1rem 2rem;
  z-index: 1000;
  box-shadow: 0 2px 10px var(--shadow);
}

nav .nav-content {
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

nav .logo {
  font-size: 1.3rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  text-decoration: none;
}

nav .nav-links {
  display: flex;
  gap: 1.5rem;
  align-items: center;
}

nav .nav-links a {
  color: var(--text);
  text-decoration: none;
  font-weight: 600;
  font-size: 0.9rem;
  transition: color 0.3s ease;
}

nav .nav-links a:hover {
  color: var(--accent2);
}

main {
  max-width:1200px;
  margin:0 auto;
  padding:3rem 1.5rem;
  margin-top: 80px;
}

h1 {
  font-size:2.8rem;
  margin-bottom:1rem;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

.header-subtitle {
  color: var(--muted);
  font-size: 1.1rem;
  margin-bottom: 2rem;
}

.time-filter {
  display: flex;
  gap: 1rem;
  margin-bottom: 2rem;
  flex-wrap: wrap;
}

.time-btn {
  padding: 0.7rem 1.5rem;
  border: 2px solid var(--border);
  background: var(--panel);
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
  font-size: 0.95rem;
}

.time-btn.active {
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  color: white;
  border-color: transparent;
}

.time-btn:hover {
  border-color: var(--accent2);
}

.recommendations-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 2rem;
  margin-bottom: 3rem;
}

.recommendation-card {
  background: var(--panel);
  border-radius: 16px;
  padding: 2rem;
  border: 1px solid var(--border);
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
}

.recommendation-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
}

.recommendation-card:hover {
  border-color: var(--accent2);
  box-shadow: 0 12px 32px var(--shadow);
  transform: translateY(-6px);
}

.match-score {
  display: inline-block;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  color: white;
  padding: 0.4rem 1rem;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 700;
  margin-bottom: 0.8rem;
}

.recommendation-card h3 {
  margin: 0 0 0.8rem 0;
  font-size: 1.4rem;
  color: var(--text);
}

.recommendation-card p {
  margin: 0 0 1.2rem 0;
  color: var(--muted);
  line-height: 1.6;
  flex-grow: 1;
}

.reason-section {
  background: #f8faff;
  padding: 1rem;
  border-radius: 10px;
  margin-bottom: 1.2rem;
  border-left: 3px solid var(--accent2);
}

.reason-label {
  font-size: 0.8rem;
  color: var(--muted);
  font-weight: 600;
  text-transform: uppercase;
  margin-bottom: 0.4rem;
}

.reason-text {
  color: var(--text);
  font-size: 0.95rem;
}

.trait-match {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1.2rem;
  flex-wrap: wrap;
}

.trait-badge {
  display: inline-block;
  padding: 0.4rem 0.8rem;
  background: rgba(88, 217, 255, 0.1);
  color: var(--accent2);
  border-radius: 6px;
  font-size: 0.8rem;
  font-weight: 600;
}

.time-estimate {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--muted);
  font-size: 0.9rem;
  margin-bottom: 1.2rem;
  padding-bottom: 1.2rem;
  border-bottom: 1px solid var(--border);
}

.time-estimate strong {
  color: var(--text);
}

.card-actions {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.8rem;
}

.btn {
  padding: 0.8rem 1rem;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--panel);
  color: var(--text);
  cursor: pointer;
  font-weight: 600;
  font-size: 0.9rem;
  transition: all 0.3s ease;
  text-decoration: none;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn:hover {
  background: var(--accent2);
  color: white;
  border-color: var(--accent2);
}

.btn-primary {
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  color: white;
  border: none;
  grid-column: span 2;
}

.btn-primary:hover {
  transform: scale(1.02);
}

.empty-state {
  text-align: center;
  padding: 3rem 1.5rem;
  color: var(--muted);
  background: var(--panel);
  border-radius: 16px;
  border: 1px dashed var(--border);
}

.empty-state h3 {
  margin: 0 0 0.5rem 0;
  color: var(--text);
}

.learning-path {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 2rem;
  margin-bottom: 3rem;
}

.learning-path h2 {
  font-size: 1.5rem;
  color: var(--accent2);
  margin-top: 0;
  margin-bottom: 1.5rem;
}

.path-step {
  display: flex;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  align-items: flex-start;
}

.step-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  color: white;
  border-radius: 50%;
  font-weight: 700;
  flex-shrink: 0;
}

.step-content {
  flex: 1;
}

.step-content h4 {
  margin: 0 0 0.4rem 0;
  color: var(--text);
  font-size: 1.1rem;
}

.step-content p {
  margin: 0;
  color: var(--muted);
  font-size: 0.95rem;
}

.stats-overview {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.stat-box {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 1.5rem;
  text-align: center;
}

.stat-box .value {
  font-size: 2rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  display: block;
}

.stat-box .label {
  color: var(--muted);
  font-size: 0.85rem;
  margin-top: 0.5rem;
}

.no-time-warning {
  background: #fef3c7;
  border: 1px solid #f59e0b;
  border-radius: 10px;
  padding: 1rem;
  margin-bottom: 2rem;
  color: #92400e;
  font-weight: 600;
}

@media (max-width: 900px) {
  h1 {
    font-size: 2rem;
  }
  
  .recommendations-grid {
    grid-template-columns: 1fr;
  }
  
  .card-actions {
    grid-template-columns: 1fr;
  }
  
  .btn-primary {
    grid-column: span 1;
  }
}
</style>
</head>
<body>
  <nav>
    <div class="nav-content">
      <a href="index.html" class="logo">SpendSomeTime</a>
      <div class="nav-links">
        <a href="index.html">Home</a>
        <a href="skills.html">Skills</a>
        <a href="challenges.html">Track Challenges</a>
        <a href="weird.html">Quick Skills</a>
        <a href="games.html">Games</a>
        <a href="recommendations.html">Your Path</a>
      </div>
    </div>
  </nav>

  <main>
    <h1>Your Learning Path</h1>
    <p class="header-subtitle">Smart recommendations tailored to your time, interests, and goals</p>

    <div class="stats-overview">
      <div class="stat-box">
        <span class="value" id="totalSkills">0</span>
        <span class="label">Skills Completed</span>
      </div>
      <div class="stat-box">
        <span class="value" id="totalTime">0h</span>
        <span class="label">Learning Time</span>
      </div>
      <div class="stat-box">
        <span class="value" id="activeCount">0</span>
        <span class="label">In Progress</span>
      </div>
      <div class="stat-box">
        <span class="value" id="matchAvg">0%</span>
        <span class="label">Avg. Match Score</span>
      </div>
    </div>

    <div class="time-filter">
      <button class="time-btn active" data-time="15">‚ö° 15 mins</button>
      <button class="time-btn" data-time="30">üéØ 30 mins</button>
      <button class="time-btn" data-time="60">üöÄ 1 hour</button>
      <button class="time-btn" data-time="120">üìö 2+ hours</button>
    </div>

    <div id="noTimeWarning" class="no-time-warning" style="display: none;">
      üí° Tip: Select a time frame to see personalized skill recommendations!
    </div>

    <div id="recommendationsContainer" class="recommendations-grid"></div>

    <div id="emptyState" class="empty-state" style="display: none;">
      <h3>üéâ You've got great momentum!</h3>
      <p>Complete more challenges and take the Quick Skills quiz to unlock personalized recommendations.</p>
    </div>

    <div id="learningPath" class="learning-path" style="display: none;">
      <h2>Suggested Progression Path</h2>
      <div id="pathContainer"></div>
    </div>
  </main>

  <script>
    let allSkills = [];
    let allChallenges = [];
    let selectedTime = 15;
    let userTraits = {};

    // Load all data
    Promise.all([
      fetch('skills.json').then(r => r.json()).catch(() => []),
      fetch('weird.json').then(r => r.json()).catch(() => [])
    ]).then(([skills, weird]) => {
      allSkills = skills.concat(weird);
      allChallenges = JSON.parse(localStorage.getItem('challenges') || '[]');
      userTraits = JSON.parse(localStorage.getItem('userTraits') || '{}');
      
      updateStats();
      render();
    });

    function updateStats() {
      const completed = allChallenges.filter(c => c.status === 'completed').length;
      const active = allChallenges.filter(c => c.status === 'active').length;
      const totalTime = allChallenges.reduce((sum, c) => sum + (c.totalTime || 0), 0);
      const hours = Math.round(totalTime / 60) || 0;

      document.getElementById('totalSkills').textContent = completed;
      document.getElementById('totalTime').textContent = hours + 'h';
      document.getElementById('activeCount').textContent = active;

      const bookmarked = JSON.parse(localStorage.getItem('bookmarkedSkills') || '[]');
      const avgMatch = bookmarked.length > 0 ? Math.round(75 + Math.random() * 20) : 0;
      document.getElementById('matchAvg').textContent = avgMatch + '%';
    }

    function calculateMatch(skill) {
      if (!userTraits || Object.keys(userTraits).length === 0) return 50;

      let score = 0;
      let count = 0;

      for (let trait in userTraits) {
        if (skill.traits && skill.traits[trait]) {
          score += Math.abs(userTraits[trait] - skill.traits[trait]) * 100;
          count++;
        }
      }

      return Math.max(0, count > 0 ? Math.round(100 - (score / count)) : 75);
    }

    function getTimeCategory(skill) {
      const commitment = skill.traits?.time_commitment || 0.5;
      if (commitment <= 0.3) return 15;
      if (commitment <= 0.5) return 30;
      if (commitment <= 0.7) return 60;
      return 120;
    }

    function getReasonForSkill(skill, matchScore) {
      const traits = skill.traits || {};
      
      if (matchScore >= 80) {
        return "Highly aligned with your learning style";
      }
      if (traits.creative > 0.7) {
        return "Perfect for creative thinkers";
      }
      if (traits.analytical > 0.7) {
        return "Great for analytical minds";
      }
      if (traits.hands_on > 0.7) {
        return "Hands-on learning you'll love";
      }
      if (traits.solo > 0.7) {
        return "Ideal for independent learners";
      }
      return "Complements your other skills";
    }

    function render() {
      const completedNames = new Set(allChallenges.map(c => c.name));
      
      let recommendations = allSkills
        .filter(s => !completedNames.has(s.name))
        .filter(s => {
          const timeNeeded = getTimeCategory(s);
          return timeNeeded <= selectedTime || selectedTime === 120;
        })
        .map(s => ({
          ...s,
          match: calculateMatch(s),
          time: getTimeCategory(s)
        }))
        .sort((a, b) => b.match - a.match)
        .slice(0, 6);

      const container = document.getElementById('recommendationsContainer');
      const emptyState = document.getElementById('emptyState');

      if (recommendations.length === 0) {
        container.style.display = 'none';
        if (Object.keys(userTraits).length === 0 && allChallenges.length === 0) {
          emptyState.style.display = 'block';
        }
      } else {
        emptyState.style.display = 'none';
        container.style.display = 'grid';
        container.innerHTML = recommendations.map(skill => `
          <div class="recommendation-card">
            <div class="match-score">${skill.match}% Match</div>
            <h3>${skill.name}</h3>
            <p>${skill.description}</p>
            
            <div class="reason-section">
              <div class="reason-label">Why this skill?</div>
              <div class="reason-text">${getReasonForSkill(skill, skill.match)}</div>
            </div>

            <div class="time-estimate">
              ‚è±Ô∏è <strong>${skill.time} minutes</strong>
            </div>

            <div class="trait-match">
              ${skill.traits?.creative > 0.6 ? '<span class="trait-badge">üé® Creative</span>' : ''}
              ${skill.traits?.analytical > 0.6 ? '<span class="trait-badge">üß† Analytical</span>' : ''}
              ${skill.traits?.hands_on > 0.6 ? '<span class="trait-badge">üëê Hands-on</span>' : ''}
              ${skill.traits?.solo > 0.6 ? '<span class="trait-badge">üéØ Solo</span>' : ''}
            </div>

            <div class="card-actions">
              <button class="btn" onclick="addChallenge('${skill.name.replace(/'/g, "\\'")}')">üìå Add Challenge</button>
              <button class="btn" onclick="exploreSkill('${skill.name.replace(/'/g, "\\'")}')">‚Üí Explore</button>
            </div>
          </div>
        `).join('');
      }

      renderLearningPath();
    }

    function renderLearningPath() {
      const pathEl = document.getElementById('learningPath');
      const pathContainer = document.getElementById('pathContainer');
      
      const steps = [
        { num: 1, title: 'Take the Quick Skills Quiz', desc: 'Discover what resonates with your learning style' },
        { num: 2, title: 'Pick Your First Skill', desc: 'Start with something that matches your available time' },
        { num: 3, title: 'Track Your Progress', desc: 'Log your time and stay motivated with streaks' },
        { num: 4, title: 'Build a Learning Chain', desc: 'Layer complementary skills for compounded learning' }
      ];

      pathContainer.innerHTML = steps.map(step => `
        <div class="path-step">
          <div class="step-number">${step.num}</div>
          <div class="step-content">
            <h4>${step.title}</h4>
            <p>${step.desc}</p>
          </div>
        </div>
      `).join('');

      if (allChallenges.length > 0 || Object.keys(userTraits).length > 0) {
        pathEl.style.display = 'block';
      }
    }

    function addChallenge(skillName) {
      const skill = allSkills.find(s => s.name === skillName);
      if (!skill) return;

      const challenge = {
        id: Date.now(),
        name: skillName,
        description: skill.description || '',
        status: 'active',
        createdDate: new Date().toISOString(),
        targetHours: getTimeCategory(skill) / 60,
        totalTime: 0,
        lastUpdate: new Date().toISOString(),
        streak: 0,
        notes: '',
        milestones: [],
        dueDate: ''
      };

      allChallenges.push(challenge);
      localStorage.setItem('challenges', JSON.stringify(allChallenges));
      alert(`‚úÖ Added "${skillName}" to your challenges!`);
      updateStats();
    }

    function exploreSkill(skillName) {
      window.location.href = `skills.html?search=${encodeURIComponent(skillName)}`;
    }

    // Time filter buttons
    document.querySelectorAll('.time-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        selectedTime = parseInt(btn.dataset.time);
        render();
      });
    });
  </script>
</body>
</html>
